<!DOCTYPE html>
  <html lang="ja-jp">
    <head>
      <title>preact-cli でポートフォリオサイトを作った</title>
      <meta charset="UTF-8">
      <meta name="author" content="hrfmmymt">
      <meta name="copyright" content="Copyright(c)hrfmmymt. 2022 All Rights Reserved.">
      <meta name="description" content="ギジュツテキ">
      <meta name="format-detection" content="telephone=no,address=no,email=no">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="theme-color" content="#fff" media="(prefers-color-scheme: light)">
      <meta name="theme-color" content="#332f21" media="(prefers-color-scheme: dark)">
      <meta property="og:description" content="ギジュツテキ">
      <meta property="og:title" content="preact-cli でポートフォリオサイトを作った">
      <meta property="og:url" content="20180606">
      <meta property="og:image" content="public/img/icon/icon.png">
      <meta property="og:type" content="website">
      <meta property="og:locale" content="ja_JP">

      <link rel="canonical" href="20180606">
      <link rel="shortcut icon" type="image/x-icon" href="public/img/icon/favicon.ico">
      <link rel="manifest" href="public/manifest.json">
      <link rel="image_src" href="public/img/icon/icon.png">
      <link rel="icon" type="image/png" href="public/img/icon/icon.png">
      <link rel="apple-touch-icon" href="public/img/icon/icon.png">
      <link rel="preconnect" href="https://fonts.googleapis.com/" crossorigin>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
      <style>a,article,blockquote,body,div,footer,h1,h2,h3,header,html,li,nav,p,time,ul{margin:0;padding:0}:root{--text-color:#000;--text-color-sub:#555;--text-color-anchor:#db2c17;--page-background-color:#fff;--code-background-color:#f4f4f4;--code-border-color:#ddd;--skeleton-color:#f4f4f4}@media (prefers-color-scheme:dark){:root{--text-color:#fff;--text-color-sub:#f2f1ef;--text-color-anchor:#00b5b5;--page-background-color:#332f21;--code-background-color:#1e1d16;--code-border-color:#424137;--skeleton-color:#272419}}html{font-size:calc(1em + .5vw)}body{font-feature-settings:"palt";-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;background-color:var(--page-background-color);color:var(--text-color);font-family:Open Sans,Helvetica Neue,sans-serif;font-kerning:normal;letter-spacing:.1em}a{color:var(--text-color-anchor)}a:visited{color:inherit}ul{list-style-type:none}.header{margin:1.5rem 0 1.2rem;text-align:center}.header-title{font-size:1rem;letter-spacing:.05rem}.header-title .header-title-link{display:block;margin:0 auto;width:6rem}.header-title .header-title-link,.header-title .header-title-link:visited{color:inherit}.logo{fill:var(--text-color)}.footer{font-size:.8rem;margin:0 auto 1.5rem;max-width:32rem;padding:0 1rem}@media screen{.hljs-comment,.hljs-quote{color:var(--gray-60-alpha)}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:var(--caution-red-100)}.hljs-attr,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#831443}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:var(--primary-green-80)}.hljs-section,.hljs-title{color:#3a71a0}.hljs-keyword,.hljs-selector-tag{color:#9d00cf}.hljs{background:#f6f6f6;color:var(--gray-70-alpha);display:block;overflow-x:auto;padding:.5em}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}}@media screen and screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}@media screen and (prefers-color-scheme:dark){.hljs-comment,.hljs-quote{color:var(--white-60-alpha)}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:var(--caution-red-vivid-100)}.hljs-attr,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#e19c40}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:var(--secondary-green-50)}.hljs-section,.hljs-title{color:#8dcfec}.hljs-keyword,.hljs-selector-tag{color:#da8eed}.hljs{background:#1e2930;color:var(--white-80-alpha);display:block;overflow-x:auto;padding:.5em}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}}@media screen and (prefers-color-scheme:dark) and screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}.post-article,.post-recent{max-width:32rem}.post-article{line-height:2;margin:0 auto}.post-article h1{font-size:2rem}.post-article h2{border-bottom:1px solid;margin-bottom:1rem}.post-article h3{margin-bottom:-1rem;margin-top:.5rem}.post-article h4{margin:0 0 -1rem}.post-article p{word-wrap:break-word;margin:1rem 0}.post-article a{text-decoration:underline}.post-article li a{word-break:break-all}.post-article img,.post-article video{background-color:var(--skeleton-color);height:auto;width:100%}.post-article code{border:1px solid var(--code-border-color);border-radius:2px;margin:1.4em 0;overflow-wrap:break-word;padding:.1em}.post-article code,.post-article pre>code{background-color:var(--code-background-color)}.post-article pre>code{border:none;display:block;margin:0;overflow:auto;padding:.6em}.post-article blockquote{word-wrap:break-word;border-left:.25em solid #dfe2e5;color:var(--text-color-sub);margin:1em 0;padding:0 1em}.post-article ul{list-style-type:disc;margin:1rem 0;padding-left:2rem}.post-article ul li ul{list-style-type:circle;margin:0}.post-article ol{padding-left:2rem}.post-article .description,.post-article time{word-wrap:break-word;color:var(--text-color-sub);font-weight:400}.post-article time{font-size:.8rem}.post-article .description{font-size:.9rem}.post-recent{margin:3rem auto}@media (max-width:414px){.post-article{padding:0 1rem}}</style>
    </head>
    <body>
      <h1 id="preact-cli-でポートフォリオサイトを作った">preact-cli でポートフォリオサイトを作った</h1>
<p><time datetime="2018-06-06">2018-06-06</time></p>
<p><em class="description">ギジュツテキ</em></p>
<h2 id="はじめに">はじめに</h2>
<p>ポートフォリオという呼称の使い方はよくわかってないので職務経歴書とでもいいましょうか、そういったものにあたる Web サイトをこの度制作し、公開しております。<br>実は以前にも同じようなプロットで Web サイトを制作・公開していたので (<a href="https://hrfmmymt.github.io/skillsheet/">https://hrfmmymt.github.io/skillsheet/</a>) 、今回はある意味リニューアルとも言えるプロジェクトとなっています。</p>
<p>以前のサイト制作当時は、もう <a href="https://github.com/hrfmmymt/skillsheet/commit/dba37d68e2c749707a85f86215f9a5e456c20cfb">丸四年以上前</a> のこととなるのですが、それは各所で業務委託に勤しんでいた頃のことです。業務委託マンとしての業務の一つとして取引先担当者に自分の概要を示すために <code>職務経歴書.xls</code> （ファイル名は当記事での便宜上のものです）を更新するというものがあるのですが、その業務というのが自分にとっては非常につまらないもので、なんとか自分の過去を前向きに振り返ることができないかと思った次の瞬間には GitHub でリポジトリを新規作成していました。そのまま半日ほど作業をし、GitHub Pages でホスティングして完成したのは非常に簡素なペライチサイトでした。</p>
<p><img src="https://lh3.googleusercontent.com/pw/AM-JKLUtWcRJbYmjeiJmY0sWJj8VoJdmWacLwB6pcaj6hzdi4lOjZN_1copVsnqHmCI45yfTIANNnlgvRLe-0KjTj59snRpiH9UXXFda5h2geGEvE_LL6k8trCFvMCD3f-ISqdlL8SwUzsMlrzFpiHtBEtcaRg" alt="img 前のポートフォリオサイトトップ画面" width="700" height="444" loading="lazy" /></p>
<p>そして今、改めて職歴サイトを再開発して公開しようと思ったのもいくつかのきっかけがあります。まず大きな一つとしては、自分の現在の所属企業にて、以前よりも深く採用に関わるようになったことがあります。<br>求職活動において用意する履歴書や職務経歴書といったいわば定型の書類は誰もが用意することと思いますが、我々のような技術職の場合、自らのスキルを示すためにコードや制作物を添えるというのが必須ではないにせよ、ある種の暗黙の了解のように扱われていると思っています。いや、思っていました。そういうものでもなかったという所感を持ったということです。いやいや、もっと作ればいいのに。もっと公開すればいいのに。という気持ちではあります。うーむ。<br>まあ、そんなようなのとか他にもいろいろがあって、丸四年前に一筆書きで作ったサイトの新バージョンを作ってみようと思い立ったのです。<br>それがこちら <a href="https://hrfmmymt.com">https://hrfmmymt.com</a> 。ここから先は技術的な解説パートとします。</p>
<p><img src="https://lh3.googleusercontent.com/pw/AM-JKLVa82hmjbyusAvjdLR4kwVF2kK6HztXalvnp9LcqkbJ7KrtGqpvXvv2js5f9Asb2qUVkte8VAFBM4aYDYliQoQrFfGQHy0NBO-RVeYs1spfwPVGRGXLMwG-HvOOjKV9fKLdmYrk6nP2d3v7z1stRTH_Zw" alt="img 新しいポートフォリオサイトトップ画面" width="700" height="388" loading="lazy" /></p>
<h2 id="preact-cli">preact-cli</h2>
<p>もうタイトルにしてしまっているのですが、<a href="https://github.com/developit/preact-cli">preact-cli</a> というツールにどっかりと乗っかっています。ざっくり言うと、この &quot;30 秒で PWA を始められる&quot; スターターで雛形を作って、あとはデザインとその他別途の作業をしていった感じです。すでに挙がっている PWA をはじめ、Preact による SPA 構築についてなど個々の技術トピックについての解説などはできるだけ最小限に抑えたり、省いたりしつつ、本項では雛形作成以降に行った作業の記録を申し訳程度で以下に記しておきます。こういう時は<a href="https://github.com/hrfmmymt/portfolio">リポジトリ</a>を見るといいですね。<br>まずは CSS から追っていきましょうか。</p>
<h3 id="クリティカル・レンダリング・パス-css-最適化">クリティカル・レンダリング・パス CSS 最適化</h3>
<p>これには、<a href="https://github.com/matthewlynch/preact-cli-plugin-critical-css">matthewlynch/preact-cli-plugin-critical-css</a> を使用しました。ただただ、滅茶苦茶お手軽でしたという感想しかないです。元になってる <a href="https://github.com/anthonygore/html-critical-webpack-plugin">anthonygore/html-critical-webpack-plugin</a> という webpack プラグインなんかは、某ギョームサービスで投入してみたいなーという気持ちにもなりました。</p>
<h3 id="css-modules">CSS Modules</h3>
<p>これは preact-cli デフォルトなんですが、例外的に書いておこうかと思います。はい、preact-cli 公式デフォルトは CSS Modules を採用しています。自分の好みとしては CSS in JS の特に styled-components だったのですが、SSR するなら自分でプラグインを書かないとなーと思いつつググってみたら <a href="https://github.com/robinvdvleuten/preact-cli-plugin-styled-components">robinvdvleuten/preact-cli-plugin-styled-components</a> が出てきて「🤔」の顔になりました（作業当時は 2 commits）。とりあえず CSS Modules のまま書いています。↑はまだ試してないのです。</p>
<p>追記。その後試してみたんですが、この issue ( <a href="https://github.com/robinvdvleuten/preact-cli-plugin-styled-components/issues/1">Doesn&#39;t work on the latest version of preact-cli · Issue #1 · robinvdvleuten/preact-cli-plugin-styled-components</a> ) と同じ現象にハマり、もういいやとなりました。</p>
<h3 id="css-その他">CSS その他</h3>
<p>あとは申し訳程度の Autoprefixer と prettier による整形くらいです。自動リンターは別にいらんと思いました。</p>
<h3 id="js-testing">JS Testing</h3>
<p>そもそも preact-cli による JS 実装を振り返ると、そこまで複雑なデザインを要求されるサイトではなかったので <a href="https://preactjs.com/">Preact</a> による React-Components と 仮想 DOM だけあればよく、さらに &quot;-cli&quot; によりルーティングと SSR と PWA というセットが簡単かつ軽量かつほぼ無思考で実装できたのが良かったなと思います。<br>ただ preact-cli は現状は、テストまでは付いてこないので自前で用意する必要がありました。とはいえテストコードはまだ TODO という形ですね。とりあえずは動くことが確認できたくらいです（このままやらないパティーンですかね）。<br>CI は CircleCI (これも自前で用意)、あとは Prettier と ESLint の --fix 連携とか。JS に関しては以上。</p>
<h3 id="pwa">PWA</h3>
<p>これも基本はほとんどやることないはずなんですけど、service-worker.js の生成にデフォルトで sw-precache を使用しているので、workbox を使いたいとかあったらカスタムする必要があります。自分は <a href="https://github.com/prateekbh/preact-cli-sw-precache">prateekbh/preact-cli-sw-precache</a> を使用しています。カスタム目的としては 404.html を ignore するとかです。</p>
<p><img src="https://lh3.googleusercontent.com/pw/AM-JKLWGOhjFMHZ8ugMIqNcdd_APNv9895c-2Fx4yW6jOgrQsnzxB-c1LIk2NtWB9otyd61rd3FaJKyk_Gi7xBcJsAL5rBdlsNOj7jyFRMdqa5e_vowvlzrzQ3-ejsmrstj0zvTWc9JTZ8RJo-o_-vW_C4LJGA" alt="img 404 のスクリーンショット" width="700" height="474" loading="lazy" /></p>
<p>泣いてるように見えるかもしれませんが、いないいないばあの「いないいない中」です。</p>
<h3 id="その他">その他</h3>
<p>一応ドメイン取って、Firebase でホスティングしています。<br>それとこれは開発技術にはあたらないですが、長らく愛用していた Sublime Text とは本件でお別れして、Visual Studio Code に乗り換えました。</p>
<p><a href="https://developers.google.com/speed/pagespeed/insights/?hl=ja&amp;url=https%3A%2F%2Fhrfmmymt.com">PageSpeed Insights</a> はこう。</p>
<p><img src="https://lh3.googleusercontent.com/pw/AM-JKLVrWtK5niGCEoCmzEcjZ1liZ1yKmSOqSbsFbf05wbd-_kL49pBT3Zk5yzQAHxE2QCJDUGWFoLmFArtTAWJxT0M688WX3nRz8XwwBEgtEa4hOhikLGt-uoyKsE2Xy4sK3-XAEPe7dA5VoTGARkN5-XCa6w" alt="img PageSpeed Insights のスクリーンショット" width="700" height="445" loading="lazy" />
<small>PC / SP 共に 90 超えの様子です。</small></p>
<h3 id="おわりに">おわりに</h3>
<p>書き切りました。とりあえず。</p>
<footer class="post-footer">&#8718;</footer><nav class="post-recent"><dl><dt>次に出た記事</dt><dd><a href="20180607">20180607</a></dd></dl></nav>
    </body>
  </html>
  